<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>Burmalda Tycoon SAVED</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        body { font-family: sans-serif; background: #121212; color: white; margin: 0; text-align: center; user-select: none; }
        .header { padding: 15px; background: #1f1f1f; border-bottom: 2px solid #333; }
        .balance { font-size: 24px; color: #f1c40f; font-weight: bold; }
        .energy { color: #2ecc71; font-size: 14px; }
        
        .tab-content { display: none; padding: 20px; height: 70vh; overflow-y: auto; }
        .active-tab { display: block; }

        .click-btn { 
            width: 200px; height: 200px; border-radius: 50%; border: none; 
            background: #f1c40f; color: black; font-size: 22px; cursor: pointer;
            box-shadow: 0 0 20px rgba(241, 196, 15, 0.4); margin-top: 50px;
        }
        .click-btn:active { transform: scale(0.95); }

        .casino-box { background: #222; padding: 15px; border-radius: 10px; margin-bottom: 10px; }
        .slots { font-size: 40px; margin: 20px 0; letter-spacing: 10px; }
        input { padding: 10px; width: 60%; border-radius: 5px; border: none; margin: 10px; background: #333; color: white; }

        .item { background: #1f1f1f; padding: 15px; margin: 10px 0; border-radius: 10px; border-left: 4px solid #f1c40f; text-align: left; }
        .item button { float: right; padding: 8px; background: #2ecc71; border: none; border-radius: 5px; color: white; }

        .nav { position: fixed; bottom: 0; width: 100%; background: #1f1f1f; display: flex; border-top: 2px solid #333; }
        .nav-btn { flex: 1; padding: 15px; background: none; border: none; color: #888; cursor: pointer; }
        .nav-btn.active { color: #f1c40f; font-weight: bold; }
    </style>
</head>
<body onload="loadData()">

<div class="header">
    <div class="balance"><span id="coins">0</span> Burmald Coin</div>
    <div class="energy">–≠–Ω–µ—Ä–≥–∏—è: <span id="energy">1000</span> / 1000</div>
    <div id="status-msg" style="font-size: 12px; color: #e74c3c; height: 15px;"></div>
</div>

<div id="tab-clicker" class="tab-content active-tab">
    <button class="click-btn" onclick="makeClick()">–ë–£–†–ú–ê–õ–î–ê</button>
    <p id="multiplier-info" style="color: #aaa; margin-top: 15px;"></p>
</div>

<div id="tab-casino" class="tab-content">
    <div class="casino-box">
        <div class="slots" id="slot-result">üé∞ üé∞ üé∞</div>
        <input type="number" id="bet-amount" placeholder="–°–∫–æ–ª—å–∫–æ –¥–µ–ø–∞–µ–º?">
        <button onclick="playCasino()" style="width: 100%; padding: 15px; background: #e74c3c; color: white; border: none; border-radius: 10px; font-weight: bold;">–ö–†–£–¢–ò–¢–¨</button>
    </div>
</div>

<div id="tab-shop" class="tab-content">
    <div class="item"><b>–≠–Ω–µ—Ä–≥–µ—Ç–∏–∫</b> (x2 –Ω–∞ 40 –º–∏–Ω) <button onclick="buyItem('energy-drink', 500)">500</button></div>
    <div class="item"><b>–°–∞–ª–∞—Ç–∏–∫</b> (+500 —ç–Ω–µ—Ä–≥–∏–∏) <button onclick="buyItem('salad', 400)">400</button></div>
    <div class="item"><b>–ß–µ—á–µ–≤–∏—á–Ω—ã–π —Å—É–ø</b> (+700 —ç–Ω–µ—Ä–≥–∏–∏) <button onclick="buyItem('soup', 600)">600</button></div>
    <div class="item"><b>–°–ª–∞–¥–∫–∞—è –∫–æ–Ω—Ñ–µ—Ç–∫–∞</b> (-100 —ç–Ω–µ—Ä–≥–∏–∏) <button onclick="buyItem('candy', 1000)">1000</button></div>
</div>

<div class="nav">
    <button class="nav-btn active" onclick="openTab('clicker', this)">–ö–ª–∏–∫–µ—Ä</button>
    <button class="nav-btn" onclick="openTab('casino', this)">–ö–∞–∑–∏–∫</button>
    <button class="nav-btn" onclick="openTab('shop', this)">–ú–∞–≥–∞–∑</button>
</div>

<script>
    let coins = 0;
    let energy = 1000;
    let clickMult = 1;
    const tg = window.Telegram.WebApp;
    tg.expand();

    // –°–û–•–†–ê–ù–ï–ù–ò–ï –î–ê–ù–ù–´–•
    function saveData() {
        const gameData = {
            coins: coins,
            energy: energy
        };
        localStorage.setItem('burmalda_save', JSON.stringify(gameData));
    }

    // –ó–ê–ì–†–£–ó–ö–ê –î–ê–ù–ù–´–•
    function loadData() {
        const saved = localStorage.getItem('burmalda_save');
        if (saved) {
            const data = JSON.parse(saved);
            coins = data.coins;
            energy = data.energy;
            updateUI();
        }
    }

    function updateUI() {
        document.getElementById('coins').innerText = Math.floor(coins);
        document.getElementById('energy').innerText = energy;
    }

    function openTab(name, btn) {
        document.querySelectorAll('.tab-content').forEach(t => t.classList.remove('active-tab'));
        document.querySelectorAll('.nav-btn').forEach(b => b.classList.remove('active'));
        document.getElementById('tab-' + name).classList.add('active-tab');
        btn.classList.add('active');
    }

    function makeClick() {
        if (energy <= 0) {
            showMsg("–ù–µ—Ç —ç–Ω–µ—Ä–≥–∏–∏! –ü–æ–µ—à—å –≤ –º–∞–≥–∞–∑–µ.");
            return;
        }
        
        if (Math.random() < 0.005) {
            coins = Math.max(0, coins - 100);
            showMsg("–ü–†–ò–®–ï–õ MELLFAN –ò –£–ö–†–ê–õ 100 –ú–û–ù–ï–¢!");
        } else {
            coins += 1 * clickMult;
            energy -= 1;
        }
        updateUI();
        saveData(); // –°–æ—Ö—Ä–∞–Ω—è–µ–º –ø–æ—Å–ª–µ –∫–ª–∏–∫–∞
        if (tg.HapticFeedback) tg.HapticFeedback.impactOccurred('light');
    }

    function playCasino() {
        let bet = parseInt(document.getElementById('bet-amount').value);
        if (isNaN(bet) || bet <= 0 || bet > coins) {
            tg.showAlert("–°—Ç–∞–≤–∫–∞ –Ω–µ –ª–µ–∑–µ—Ç!");
            return;
        }
        coins -= bet;
        let res = Math.random() * 100;
        let slots = document.getElementById('slot-result');
        
        if (res < 1.0) { // 1% —à–∞–Ω—Å
            slots.innerText = "üíé üíé üíé";
            coins += bet * 100;
            tg.showAlert("–£–õ–¨–¢–†–ê –ó–ê–ù–û–° X100!");
        } else if (res < 10.0) {
            slots.innerText = "üçã üçã üçã";
            coins += bet * 5;
        } else if (res < 25.0) {
            slots.innerText = "üçí üçí üçí";
            coins += bet * 2;
        } else {
            slots.innerText = "üí© ü§° üí©";
        }
        updateUI();
        saveData(); // –°–æ—Ö—Ä–∞–Ω—è–µ–º –ø–æ—Å–ª–µ –∫–∞–∑–∏–∫–∞
    }

    function buyItem(id, price) {
        if (coins < price) {
            tg.showAlert("–î–µ–Ω–µ–≥ –Ω–µ—Ç.");
            return;
        }
        coins -= price;
        if (id === 'energy-drink') {
            clickMult = 2;
            document.getElementById('multiplier-info').innerText = "–ê–∫—Ç–∏–≤–µ–Ω X2 –≠–Ω–µ—Ä–≥–µ—Ç–∏–∫";
            setTimeout(() => { clickMult = 1; document.getElementById('multiplier-info').innerText = ""; }, 2400000);
        } else if (id === 'salad') energy = Math.min(1000, energy + 500);
        else if (id === 'soup') energy = Math.min(1000, energy + 700);
        else if (id === 'candy') energy = Math.max(0, energy - 100);
        
        updateUI();
        saveData(); // –°–æ—Ö—Ä–∞–Ω—è–µ–º –ø–æ—Å–ª–µ –ø–æ–∫—É–ø–∫–∏
    }

    function showMsg(txt) {
        let m = document.getElementById('status-msg');
        m.innerText = txt;
        setTimeout(() => m.innerText = "", 3000);
    }

    // –ê–≤—Ç–æ-—Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∫–∞–∂–¥—ã–µ 5 —Å–µ–∫—É–Ω–¥ –Ω–∞ –≤—Å—è–∫–∏–π —Å–ª—É—á–∞–π
    setInterval(saveData, 5000);
</script>

</body>
</html>
