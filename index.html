<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>Burmalda Tycoon Pro + MultiSound</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        body { font-family: sans-serif; background: #121212; color: white; margin: 0; text-align: center; user-select: none; overflow: hidden; }
        .header { padding: 15px; background: #1f1f1f; border-bottom: 2px solid #333; }
        .balance { font-size: 24px; color: #f1c40f; font-weight: bold; }
        .energy { color: #2ecc71; font-size: 14px; }
        .tab-content { display: none; padding: 20px; height: 70vh; overflow-y: auto; }
        .active-tab { display: block; }

        .click-btn { 
            width: 200px; height: 200px; border-radius: 50%; border: none; 
            background: #f1c40f; color: black; font-size: 22px; cursor: pointer;
            box-shadow: 0 0 20px rgba(241, 196, 15, 0.4); margin-top: 50px;
            transition: transform 0.05s;
        }
        .click-btn:active { transform: scale(0.95); }

        .casino-box { background: #222; padding: 20px; border-radius: 15px; margin-bottom: 10px; }
        .slots-wrapper { display: flex; justify-content: center; gap: 10px; margin: 20px 0; }
        .slot { 
            font-size: 45px; background: #333; width: 70px; height: 80px; 
            line-height: 80px; border-radius: 10px; border: 2px solid #444;
        }
        .spinning { animation: blur 0.1s infinite; }
        @keyframes blur { 0% { filter: blur(0px); } 50% { filter: blur(4px); transform: translateY(2px); } 100% { filter: blur(0px); } }

        input { padding: 12px; width: 80%; border-radius: 8px; border: none; margin: 10px; background: #333; color: white; text-align: center; font-size: 18px; }

        .item { background: #1f1f1f; padding: 15px; margin: 10px 0; border-radius: 10px; border-left: 4px solid #f1c40f; text-align: left; }
        .item button { float: right; padding: 10px 15px; background: #2ecc71; border: none; border-radius: 5px; color: white; font-weight: bold; }

        .nav { position: fixed; bottom: 0; width: 100%; background: #1f1f1f; display: flex; border-top: 2px solid #333; height: 65px; }
        .nav-btn { flex: 1; background: none; border: none; color: #888; cursor: pointer; font-size: 14px; }
        .nav-btn.active { color: #f1c40f; font-weight: bold; border-top: 3px solid #f1c40f; }
    </style>
</head>
<body onload="loadData()">

<div class="header">
    <div class="balance"><span id="coins">0</span> Burmald Coin</div>
    <div class="energy">–≠–Ω–µ—Ä–≥–∏—è: <span id="energy">1000</span> / 1000</div>
    <div id="status-msg" style="font-size: 13px; color: #e74c3c; height: 18px; margin-top: 5px;"></div>
</div>

<div id="tab-clicker" class="tab-content active-tab">
    <button class="click-btn" onclick="makeClick()">–ë–£–†–ú–ê–õ–î–ê</button>
    <p id="multiplier-info" style="color: #aaa; margin-top: 20px;"></p>
</div>

<div id="tab-casino" class="tab-content">
    <div class="casino-box">
        <div class="slots-wrapper">
            <div class="slot" id="s1">üé∞</div>
            <div class="slot" id="s2">üé∞</div>
            <div class="slot" id="s3">üé∞</div>
        </div>
        <input type="number" id="bet-amount" placeholder="–°—Ç–∞–≤–∫–∞ (–¥–µ–ø)">
        <button id="spin-btn" onclick="playCasino()" style="width: 100%; padding: 15px; background: #e74c3c; color: white; border: none; border-radius: 10px; font-weight: bold; font-size: 18px;">–ö–†–£–¢–ò–¢–¨</button>
    </div>
</div>

<div id="tab-shop" class="tab-content">
    <div class="item"><b>–≠–Ω–µ—Ä–≥–µ—Ç–∏–∫</b> (x2 –Ω–∞ 40 –º–∏–Ω) <button onclick="buyItem('energy-drink', 500)">500</button></div>
    <div class="item"><b>–°–∞–ª–∞—Ç–∏–∫</b> (+500 —ç–Ω–µ—Ä–≥–∏–∏) <button onclick="buyItem('salad', 400)">400</button></div>
    <div class="item"><b>–ß–µ—á–µ–≤–∏—á–Ω—ã–π —Å—É–ø</b> (+700 —ç–Ω–µ—Ä–≥–∏–∏) <button onclick="buyItem('soup', 600)">600</button></div>
    <div class="item"><b>–°–ª–∞–¥–∫–∞—è –∫–æ–Ω—Ñ–µ—Ç–∫–∞</b> (-100 —ç–Ω–µ—Ä–≥–∏–∏) <button onclick="buyItem('candy', 1000)">1000</button></div>
</div>

<div class="nav">
    <button class="nav-btn active" onclick="openTab('clicker', this)">–ö–ª–∏–∫–µ—Ä</button>
    <button class="nav-btn" onclick="openTab('casino', this)">–ö–∞–∑–∏–∫</button>
    <button class="nav-btn" onclick="openTab('shop', this)">–ú–∞–≥–∞–∑</button>
</div>

<script>
    let coins = 0;
    let energy = 1000;
    let clickMult = 1;
    let isSpinning = false;
    const tg = window.Telegram.WebApp;
    tg.expand();

    // --- –û–ë–ù–û–í–õ–ï–ù–ù–´–ï –ó–í–£–ö–ò ---
    const sounds = {
        click: new Audio('click.mp3'),
        win: new Audio('win.mp3'),
        loss: new Audio('loss.mp3'),
        mellfan: new Audio('mellfan.mp3'),
        saladSnd: new Audio('salad.mp3'), // –ó–≤—É–∫ –¥–ª—è —Å–∞–ª–∞—Ç–∞
        soupSnd: new Audio('soup.mp3')     // –ó–≤—É–∫ –¥–ª—è —Å—É–ø–∞
    };

    function playSnd(name) {
        const s = sounds[name];
        if (s) { s.currentTime = 0; s.play().catch(() => {}); }
    }

    function saveData() { localStorage.setItem('burmalda_save', JSON.stringify({ coins, energy })); }

    function loadData() {
        const saved = localStorage.getItem('burmalda_save');
        if (saved) {
            const data = JSON.parse(saved);
            coins = data.coins || 0;
            energy = data.energy || 1000;
            updateUI();
        }
    }

    function updateUI() {
        document.getElementById('coins').innerText = Math.floor(coins);
        document.getElementById('energy').innerText = energy;
    }

    function openTab(name, btn) {
        document.querySelectorAll('.tab-content').forEach(t => t.classList.remove('active-tab'));
        document.querySelectorAll('.nav-btn').forEach(b => b.classList.remove('active'));
        document.getElementById('tab-' + name).classList.add('active-tab');
        btn.classList.add('active');
        playSnd('click');
    }

    function makeClick() {
        if (energy <= 0) { showMsg("–≠–Ω–µ—Ä–≥–∏—è –Ω–∞ –Ω—É–ª–µ!"); return; }
        if (Math.random() < 0.005) {
            coins = Math.max(0, coins - 100);
            showMsg("MELLFAN –£–ö–†–ê–õ 100 –ú–û–ù–ï–¢!");
            playSnd('mellfan');
        } else {
            coins += 1 * clickMult;
            energy -= 1;
            playSnd('click');
        }
        updateUI();
        saveData();
        if (tg.HapticFeedback) tg.HapticFeedback.impactOccurred('light');
    }

    function playCasino() {
        if (isSpinning) return;
        let bet = parseInt(document.getElementById('bet-amount').value);
        if (isNaN(bet) || bet <= 0 || bet > coins) { tg.showAlert("–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –º–æ–Ω–µ—Ç!"); return; }

        isSpinning = true;
        coins -= bet;
        updateUI();
        
        const slotElements = [document.getElementById('s1'), document.getElementById('s2'), document.getElementById('s3')];
        const symbols = ['üíé', 'üçã', 'üçí', 'üí©', 'ü§°', '7Ô∏è‚É£'];
        
        slotElements.forEach(el => el.classList.add('spinning'));
        playSnd('click');

        setTimeout(() => {
            isSpinning = false;
            slotElements.forEach(el => el.classList.remove('spinning'));
            
            let res = Math.random() * 100;
            let finalSlots = [];

            if (res < 1.0) { 
                finalSlots = ['üíé', 'üíé', 'üíé'];
                coins += bet * 100;
                playSnd('win');
                tg.showAlert("–£–õ–¨–¢–†–ê –ó–ê–ù–û–° X100!");
            } else if (res < 15.0) {
                finalSlots = ['üçã', 'üçã', 'üçã'];
                coins += bet * 5;
                playSnd('win');
            } else if (res < 35.0) {
                finalSlots = ['üçí', 'üçí', 'üçí'];
                coins += bet * 2;
                playSnd('win');
            } else {
                finalSlots = [symbols[Math.floor(Math.random()*symbols.length)], symbols[Math.floor(Math.random()*symbols.length)], symbols[Math.floor(Math.random()*symbols.length)]];
                playSnd('loss');
            }

            slotElements[0].innerText = finalSlots[0];
            slotElements[1].innerText = finalSlots[1];
            slotElements[2].innerText = finalSlots[2];
            updateUI();
            saveData();
        }, 1500);
    }

    function buyItem(id, price) {
        if (coins < price) { tg.showAlert("–ú–∞–ª–æ –±—É—Ä–º–∞–ª–¥ –∫–æ–∏–Ω–æ–≤!"); return; }
        
        if (id === 'energy-drink') {
            coins -= price;
            clickMult = 2;
            playSnd('click');
            document.getElementById('multiplier-info').innerText = "–ê–∫—Ç–∏–≤–µ–Ω X2 –≠–Ω–µ—Ä–≥–µ—Ç–∏–∫";
            setTimeout(() => { clickMult = 1; document.getElementById('multiplier-info').innerText = ""; }, 2400000);
        } else if (id === 'salad') {
            coins -= price;
            energy = Math.min(1000, energy + 500);
            playSnd('saladSnd'); // –¢–≤–æ–π —É–Ω–∏–∫–∞–ª—å–Ω—ã–π –∑–≤—É–∫ –¥–ª—è —Å–∞–ª–∞—Ç–∞
        } else if (id === 'soup') {
            coins -= price;
            energy = Math.min(1000, energy + 700);
            playSnd('soupSnd'); // –¢–≤–æ–π —É–Ω–∏–∫–∞–ª—å–Ω—ã–π –∑–≤—É–∫ –¥–ª—è —Å—É–ø–∞
        } else if (id === 'candy') {
            coins -= price;
            energy = Math.max(0, energy - 100);
            playSnd('click');
            showMsg("–ö–æ–Ω—Ñ–µ—Ç–∫–∞ –æ–∫–∞–∑–∞–ª–∞—Å—å –Ω–µ–≤–∫—É—Å–Ω–æ–π...");
        }
        updateUI();
        saveData();
    }

    function showMsg(txt) {
        let m = document.getElementById('status-msg');
        m.innerText = txt;
        setTimeout(() => m.innerText = "", 3000);
    }

    setInterval(saveData, 5000);
</script>
</body>
</html>
